#!/usr/bin/env bash

i3status | while :
do
	read line
	cpu_temperature=$(sensors | grep CPUTIN | awk '{ print $2 }' | sed -e s/+//)
	gpu_temperature=$(sensors | grep radeon -C 2 | tail -n 1 | awk '{ print $2 }' | sed -e s/+//)
	gpu_performance_level=$(cat /sys/class/drm/card0/device/power_dpm_force_performance_level)
	gpu_power_level=$(sudo cat /sys/kernel/debug/dri/0/radeon_pm_info |  grep "power level" | awk '{ print $3 }')
	date_time=$(date +'%Y-%m-%d %H:%M:%S')
	echo "$line | CPU: $cpu_temperature | GPU: $gpu_temperature ($gpu_performance_level@$gpu_power_level) | $date_time" || exit 1
done

